# AI Context-Aware Study Coach

A complete microservice-based mobile application that uses the phone camera (hardware input) to scan notes and provides AI-generated **multiple choice quizzes**, summaries, and flashcards. Features hardware outputs including display, and TTS audio.

## What It Does

The AI Study Coach app allows you to:
1. **Scan your notes** using your phone's camera (handwritten or printed text)
2. **Extract text** from images using OCR (Optical Character Recognition)
3. **Generate study materials** using AI:
   - **Multiple choice quizzes only** - Interactive questions with immediate feedback (this is the only quiz type generated by the app)
   - **Summaries** - AI-generated summaries of your notes
   - **Flashcards** - Front/back card format for memorization
4. **Study interactively** with:
   - Immediate feedback on quiz answers (correct âœ“ / incorrect âœ—)
   - Text-to-speech to hear questions and summaries


## Features

- ğŸ“· **Camera Input**: Scan handwritten or printed notes using phone camera (hardware input)
- ğŸ¤– **AI-Powered Multiple Choice Quiz Generation**: 
  - **Multiple choice questions only** - The mobile app generates and displays only multiple choice quizzes with immediate feedback (correct/incorrect indicators)
  - Interactive quiz interface with tap-to-reveal answers and explanations
  - Note: Other quiz types (fill-in-the-blank, short answer) are supported by the API but not implemented in the mobile app UI
  - Flashcards with front/back card format
  - AI-generated summaries of scanned content
- ğŸ“± **Hardware Outputs**:
  - Display: Multiple choice quiz questions with immediate correct/incorrect feedback and tap-to-reveal answers
  - TTS Audio: Read questions and summaries aloud
  - Vibration: Haptic feedback for interactions (success patterns for correct answers, error patterns for incorrect)
- ğŸ—ï¸ **Microservice Architecture**: 
  - OCR Service (standalone)
  - API Gateway/Orchestrator
  - Ollama LLM Service
- ğŸ³ **Dockerized**: Complete Docker Compose setup
- ğŸ§  **Ollama Integration**: Local LLM for privacy
- âœ… **50%+ AI-Generated Code**: Integration code, API interfaces, prompts

## Project Structure

```
CS468_Proj2/
â”œâ”€â”€ ocr-service/            # OCR Microservice (FastAPI)
â”‚   â”œâ”€â”€ main.py            # OCR service application
â”‚   â”œâ”€â”€ requirements.txt   # Python dependencies
â”‚   â””â”€â”€ Dockerfile         # OCR container config
â”œâ”€â”€ api-gateway/           # API Gateway/Orchestrator (FastAPI)
â”‚   â”œâ”€â”€ main.py           # Gateway application
â”‚   â”œâ”€â”€ requirements.txt  # Python dependencies
â”‚   â””â”€â”€ Dockerfile        # Gateway container config
â”œâ”€â”€ mobile-app/            # React Native mobile app (Expo)
â”‚   â”œâ”€â”€ App.js            # Main app component
â”‚   â”œâ”€â”€ services/         # API service layer
â”‚   â”‚   â””â”€â”€ api.js        # API Gateway client
â”‚   â”œâ”€â”€ utils/            # Utility functions
â”‚   â”‚   â””â”€â”€ ipDetector.js # Automatic IP detection
â”‚   â””â”€â”€ package.json      # Node dependencies
â”œâ”€â”€ tests/                 # Comprehensive test suite
â”‚   â”œâ”€â”€ test_ocr_service.py    # OCR unit tests
â”‚   â”œâ”€â”€ test_api_gateway.py    # Gateway unit tests
â”‚   â”œâ”€â”€ test_integration.py    # Integration tests
â”‚   â”œâ”€â”€ test_backend.py        # Backend API tests
â”‚   â”œâ”€â”€ TESTING_WALKTHROUGH.md  # Testing guide
â”‚   â””â”€â”€ requirements.txt       # Test dependencies
â”œâ”€â”€ docker-compose.yml     # Docker orchestration (all services)
â”œâ”€â”€ DESIGN.md             # Complete architecture design
â”œâ”€â”€ SETUP_AND_RUN.md      # Setup and run instructions
â”œâ”€â”€ TESTING_REPORT.md     # Testing documentation
â”œâ”€â”€ REFLECTION.md         # Development reflection
â””â”€â”€ README.md             # This file
```

## Prerequisites

- Docker and Docker Compose
- Python 3.11+ (for local development)
- Node.js and npm (for mobile app development)
- Expo CLI (for React Native development)

## Quick Start

### 1. Clone the Repository

```bash
git clone <YOUR_REPO_URL>
cd CS468_Proj2
```

### 2. Start Docker Services

```bash
# Start all microservices (OCR, API Gateway, Ollama)
docker-compose up -d

# Pull the Ollama model (first time only, may take several minutes)
docker exec study-coach-ollama ollama pull llama3.2:1b

# Verify model is available
docker exec study-coach-ollama ollama list
```

### 3. Verify Services

```bash
# Check API Gateway health
curl http://localhost:8000/health

# Check OCR Service health
curl http://localhost:8001/health

# Check Ollama
curl http://localhost:11434/api/tags
```

### 4. Run Tests

```bash
# Install test dependencies (including uvicorn for API gateway imports)
pip install -r tests/requirements.txt
pip install uvicorn python-multipart

# Set Python path and run tests
PYTHONPATH=/path/to/project/api-gateway:$PYTHONPATH pytest tests/ -v
```

### 5. Start Mobile App

```bash
cd mobile-app
npm install
npm start or npx expo start --tunnel (if not using Mac)
```

## API Endpoints

### API Gateway Endpoints

**Health Check**
```
GET /health
```

**Scan Image (OCR)**
```
POST /api/scan
Content-Type: multipart/form-data
Body: file (image file)
Response: {"success": true, "text": "extracted text"}
```

**Generate Quiz (Multiple Choice)**
```
POST /api/generate_quiz
Content-Type: application/json
Body: {
  "text": "extracted text",
  "quiz_type": "multiple_choice" | "all" | "fill_blank" | "short_answer"
}
Response: {
  "success": true,
  "quiz": {
    "multiple_choice": [
      {
        "question": "...",
        "options": ["...", "...", "...", "..."],
        "correct_answer": 0,
        "explanation": "..."
      }
    ]
  }
}
```
Note: The mobile app **only generates multiple choice quizzes**. While the API supports other quiz types (`fill_blank`, `short_answer`, `all`), the mobile app interface is designed exclusively for multiple choice questions with immediate feedback.

**Generate Summary**
```
POST /api/summary
Content-Type: application/json
Body: {"text": "extracted text"}
Response: {"success": true, "summary": "..."}
```

**Generate Flashcards**
```
POST /api/generate_flashcards
Content-Type: application/json
Body: {"text": "extracted text"}
Response: {"success": true, "flashcards": [...]}
```

### OCR Service Endpoints

**Health Check**
```
GET /health
```

**Extract Text**
```
POST /extract
Content-Type: multipart/form-data
Body: file (image file)
Response: {"success": true, "text": "extracted text"}
```

## Configuration

### Environment Variables

**API Gateway** (in `docker-compose.yml`):
- `OCR_SERVICE_URL`: OCR service URL (default: `http://ocr-service:8001`)
- `LLM_SERVICE_URL`: Ollama service URL (default: `http://ollama:11434`)
- `OLLAMA_MODEL`: LLM model name (default: `llama3.2:1b`)
- `TTS_ENABLED`: Enable TTS features (default: `true`)

**OCR Service** (in `docker-compose.yml`):
- `TESSERACT_CMD`: Tesseract executable path (default: `/usr/bin/tesseract`)

**Mobile App** (in `mobile-app/services/api.js`):
- The app **automatically detects** your computer's IP address on startup
- **Auto-detection works best on home WiFi networks**
- **University/enterprise networks** often have client isolation - use manual IP entry in Settings if auto-detection fails
- If auto-detection fails, you can manually configure the IP in the app's Settings screen
- Manual IP entry works on **all devices and networks** - this is the most reliable method
- See `TROUBLESHOOTING.md` for more details on IP detection limitations

## Development

### Backend Development

```bash
# API Gateway Development
cd api-gateway
pip install -r requirements.txt

# Run locally (requires Ollama and OCR service running)
uvicorn main:app --reload --host 0.0.0.0 --port 8000

# OCR Service Development
cd ocr-service
pip install -r requirements.txt
uvicorn main:app --reload --host 0.0.0.0 --port 8001
```

### Mobile App Development

```bash
cd mobile-app
npm install
npm start

# For iOS
npm run ios

# For Android
npm run android
```

## Testing

**Test Status**: 29 tests passing, 0 failed, 0 skipped - 100% pass rate

All tests are designed to work without requiring services to be running (using mocks). The test suite covers all core functionality including:
- Image scanning (OCR)
- Multiple choice quiz generation
- Summary generation
- Flashcard generation
- Health checks
- Comprehensive edge cases

### Run All Tests
```bash
# Install test dependencies (including uvicorn for API gateway imports)
pip install -r tests/requirements.txt
pip install uvicorn python-multipart

# Set Python path and run all tests (from project root)
PYTHONPATH=$(pwd)/api-gateway:$PYTHONPATH pytest tests/ -v
```

### Run Specific Test Suites
```bash
# OCR Service tests
pytest tests/test_ocr_service.py -v

# API Gateway tests
pytest tests/test_api_gateway.py -v

# Integration tests
pytest tests/test_integration.py -v
```

### Run with Coverage
```bash
pytest tests/ --cov=api-gateway --cov=ocr-service --cov-report=html
```

See `tests/TESTING_WALKTHROUGH.md` for comprehensive testing documentation.

## Troubleshooting

### Ollama Service Not Available
```bash
# Check if Ollama container is running
docker ps | grep ollama

# Restart Ollama
docker-compose restart ollama

# Pull model if missing
docker exec study-coach-ollama ollama pull llama3.2:1b
```

### OCR Not Working
- Ensure Tesseract is installed in the Docker container
- Check image quality and format (JPEG, PNG supported)
- Verify file upload is successful
- Make sure images are clear and well-lit for better text extraction

## Documentation

- **DESIGN.md**: Complete architecture design with microservice diagrams, data flow, and AI tool mapping
- **SETUP_AND_RUN.md**: Step-by-step setup and run instructions
- **TROUBLESHOOTING.md**: Common issues and solutions
- **DEVICE_COMPATIBILITY.md**: IP auto-detection compatibility across devices and networks
- **tests/TESTING_WALKTHROUGH.md**: Comprehensive testing guide with debugging walkthroughs
- **TESTING_REPORT.md**: Testing documentation with results

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests for new functionality
5. Submit a pull request


## Acknowledgments

- Ollama for providing local LLM capabilities
- Tesseract OCR for text extraction
- FastAPI for the web framework
- React Native and Expo for mobile development

